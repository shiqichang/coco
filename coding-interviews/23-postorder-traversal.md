# 23 äºŒå‰æœç´¢æ ‘çš„ååºéå†åºåˆ—

> ğŸŒŸ **å‰‘æŒ‡ Offer ç³»åˆ—**
>
> ç»™å²æœˆä»¥æ–‡æ˜ï¼Œè€Œä¸æ˜¯ç»™æ–‡æ˜ä»¥å²æœˆã€‚

## é¢˜ç›®æè¿°

è¾“å…¥ä¸€ä¸ªæ•´æ•°æ•°ç»„ï¼Œåˆ¤æ–­è¯¥æ•°ç»„æ˜¯ä¸æ˜¯æŸäºŒå‰æœç´¢æ ‘çš„ååºéå†çš„ç»“æœã€‚å¦‚æœæ˜¯åˆ™è¿”å›true,å¦åˆ™è¿”å›falseã€‚å‡è®¾è¾“å…¥çš„æ•°ç»„çš„ä»»æ„ä¸¤ä¸ªæ•°å­—éƒ½äº’ä¸ç›¸åŒã€‚

## é¢˜è§£

```python
def verify_sequence_of_bst(sequence):
    """ é€’å½’åˆ†æ²» """
    if not sequence:
        return False
    
    def recur(i, j):
        if i >= j:
            return True
        p = i
        while sequence[p] < sequence[j]:
            p += 1
        m = p
        while sequence[p] > sequence[j]:
            p += 1
        return p == j and recur(i, m - 1) and recur(m, j - 1)

    return recur(0, len(sequence) - 1)
```

```python
def verify_sequence_of_bst(sequence):
    """ å•è°ƒè¾…åŠ©æ ˆ """
    stack, root = [], float("+inf")
    for i in range(len(sequence) - 1, -1, -1):
        if sequence[i] > root:
            return False
        while stack and sequence[i] < stack[-1]:
            root = stack.pop()
        stack.append(sequence[i])
    return True
```

![1](https://tva1.sinaimg.cn/large/007S8ZIlly1gilnwsvtivj30ls0gctaf.jpg)

*äºŒå‰æœç´¢æ ‘ (Binary Search Tree, BST): å·¦å­©å­ < æ ¹ç»“ç‚¹ < å³å­©å­ï¼Œå®ƒçš„å·¦å­©å­å’Œå³å­©å­ä¹Ÿéƒ½æ˜¯ BST.*

ğŸ¥ **è€ƒå¯Ÿè¦ç‚¹**ï¼šäºŒå‰æœç´¢æ ‘ã€æ ‘çš„ååºéå†ã€æ ˆ

ğŸ¬ **è§£é¢˜æ€è·¯**ï¼šé€’å½’åˆ†æ²»ï¼›è¾…åŠ©å•è°ƒæ ˆã€‚

- **é€’å½’åˆ†æ²»**ï¼šæ—¶é—´å¤æ‚åº¦ä¸º `O(n^2)`
  - **åˆ’åˆ†å·¦å³å­æ ‘**ï¼Œå¯»æ‰¾**ç¬¬ä¸€ä¸ªå¤§äºæ ¹ç»“ç‚¹**çš„ç»“ç‚¹ï¼Œç´¢å¼•è®°ä¸º `m`, å¯ä»¥å¾—å‡ºå·¦å­æ ‘åŒºé—´ `[i, m-1]`, å³å­æ ‘åŒºé—´ `[m, j-1]`, æ ¹ç»“ç‚¹ç´¢å¼•ä¸º `j`.
  - **åˆ¤æ–­æ˜¯å¦ä¸ºäºŒå‰æœç´¢æ ‘**ï¼šå·¦å­æ ‘åŒºé—´ `[i, m-1]` å†…æ‰€æœ‰çš„ç»“ç‚¹ `< postorder[j]`, å³å­æ ‘åŒºé—´ `[m, j-1]` å†…æ‰€æœ‰çš„ç»“ç‚¹ `> postorder[j]`. é‡åˆ° `>=` çš„ç»“ç‚¹å°±è·³å‡ºï¼Œæ­¤æ—¶é€šè¿‡ `p==j` åˆ¤æ–­æ˜¯å¦ä¸ºäºŒå‰æœç´¢æ ‘ã€‚
- **è¾…åŠ©å•è°ƒæ ˆ**ï¼šååºéå†å€’åºä¸º**æ ¹å³å·¦** `[rn,rn-1,...,r1]`
  - å½“ `ri > ri+1` æ—¶ï¼Œ`ri` ä¸€å®šæ˜¯ `ri+1` çš„å³å­ç»“ç‚¹
  - å½“ `ri < ri+1` æ—¶ï¼Œ`ri` ä¸€å®šæ˜¯æŸç»“ç‚¹ `root` çš„å·¦å­ç»“ç‚¹ï¼Œä¸” `root` ä¸º `ri+1, ri+2,...,rn` ä¸­å€¼å¤§äºä¸”æœ€æ¥è¿‘ `ri` çš„ç»“ç‚¹ã€‚

ğŸ‰ **æ—¶é—´å¤æ‚åº¦**ï¼šO(n)

ğŸ­ **ç©ºé—´å¤æ‚åº¦**ï¼šO(n)
